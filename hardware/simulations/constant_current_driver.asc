Version 4
SHEET 1 1632 712
WIRE 480 -272 288 -272
WIRE 480 -192 480 -272
WIRE 288 -176 288 -272
WIRE -432 -144 -496 -144
WIRE -496 -96 -496 -144
WIRE 480 -48 480 -112
WIRE -496 16 -496 -16
WIRE 288 16 288 -96
WIRE 288 16 176 16
WIRE 176 96 176 16
WIRE -432 112 -432 -144
WIRE -464 128 -560 128
WIRE -256 144 -400 144
WIRE -64 144 -176 144
WIRE 112 144 -64 144
WIRE -464 160 -928 160
WIRE -432 224 -432 176
WIRE -928 272 -928 160
WIRE -64 272 -64 144
WIRE 288 320 288 16
WIRE 176 368 176 192
WIRE 224 368 176 368
WIRE -928 432 -928 352
WIRE -64 432 -64 352
WIRE -560 480 -560 128
WIRE 288 480 288 416
WIRE 288 480 -560 480
WIRE 288 512 288 480
WIRE 288 672 288 592
FLAG 288 672 0
FLAG -64 432 0
FLAG 480 -48 0
FLAG -928 432 0
FLAG -432 224 0
FLAG -496 16 0
SYMBOL npn 112 96 R0
SYMATTR InstName Q1
SYMATTR Value FMMT458
SYMBOL npn 224 320 R0
SYMATTR InstName Q2
SYMATTR Value 2SCR564F3
SYMBOL res 272 496 R0
SYMATTR InstName R1
SYMATTR Value 1
SYMATTR SpiceLine tol=1 pwr=0.25
SYMBOL res -80 256 R0
SYMATTR InstName R2
SYMATTR Value 10K
SYMATTR SpiceLine tol=1 pwr=0.063
SYMBOL res -160 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 200
SYMATTR SpiceLine tol=1 pwr=0.063
SYMBOL res 272 -192 R0
SYMATTR InstName R4
SYMATTR Value 55
SYMATTR SpiceLine tol=1 pwr=5
SYMBOL voltage 480 -208 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 15
SYMBOL voltage -928 256 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 24 96 Left 1
SYMATTR Value PULSE(0 0.2 1 0.5 0.5 2 4)
SYMATTR InstName V2
SYMBOL OpAmps\\AD712 -432 80 R0
SYMATTR InstName U1
SYMBOL voltage -496 -112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 5
TEXT -936 648 Left 2 !.tran 10
TEXT 712 -152 Left 0 !.MODEL FMMT458 NPN ( IS=5.32E-14 NF=1 BF=230 IKF=1.5 VAF=1500\n    + ISE=2.1E-14 NE=1.385 NR=1.05 BR=8 IKR=0.7 VAR=64 ISC=6.42E-12\n    + NC=1.25 RB=0.5 RE=0.224 RC=0.134 QUASIMOD=1 RCO=80 GAMMA=4E-7\n    + CJC=9.5E-12 MJC=0.32 VJC=0.4 CJE=115E-12 MJE=0.37 VJE=0.8\n    + TF=1.3E-9 TR=16E-6 TRC1=.004 TRB1=.004 TRE1=.004 XTB=1.4 )
TEXT 440 360 Left 1 ;In real circuit I used BUJ302AD for Q2.  I just could not find SPICE model for that BJT.\nBUJ302AD: Ic = 4A, Vceo = 400V, Vebo = 24V, Ptot = 80W
TEXT -496 264 Left 1 ;In reality this Op-Amp will be inside a PIC uController
